<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î’Ï…Î¶Î±Î½Ï„Î¹Î½Î¬ ÎšÏÏ…Ï€Ï„ÏŒÎ»ÎµÎ¾Î±</title>
    <style>
        :root {
            --primary: #4a90e2;
            --bg: #eef2f5;
            --box-bg: #2c3e50;
            --text-color: #333;
            --success: #27ae60;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* --- Header & Logo --- */
        .header-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 25px;
            text-align: center;
        }

        h1 {
            color: var(--box-bg);
            /* Î‘Ï…Î¾Î®Î¸Î·ÎºÎµ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… Ï„Î¯Ï„Î»Î¿Ï… ÎºÎ±Ï„Î¬ 10% (1.8rem -> 2rem) */
            font-size: 2rem; 
            margin: 0;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
            font-weight: 700;
        }

        .title-logo {
            /* Î‘Ï…Î¾Î®Î¸Î·ÎºÎµ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… Î»Î¿Î³Î¿Ï„ÏÏ€Î¿Ï… ÎºÎ±Ï„Î¬ 15% (50px -> 65px) */
            height: 65px; 
            width: auto;
            margin-right: 15px;
            vertical-align: middle;
            /* ÎšÎ¬Î½ÎµÎ¹ Ï„Î¿ Î»Î¿Î³ÏŒÏ„Ï…Ï€Î¿ Î½Î± "Î±Î½Î±Î¼ÎµÎ¹Î³Î½ÏÎµÏ„Î±Î¹" Î¼Îµ Ï„Î¿ Ï†ÏŒÎ½Ï„Î¿ */
            mix-blend-mode: multiply; 
        }
        
        .title-logo[src=""] { display: none; }

        /* --- Main Layout --- */
        main {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        /* --- Quote Section --- */
        #quote-area {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            max-width: 900px;
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            width: 95%;
        }

        .word-group {
            display: flex;
            gap: 2px;
            margin-bottom: 5px;
            flex-wrap: nowrap;
        }

        /* --- Clues Section --- */
        #clues-area {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            width: 100%;
            max-width: 1000px;
            margin-bottom: 30px;
        }

        .clue-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: white;
            padding: 10px 15px;
            border-radius: 12px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            flex-wrap: wrap;
            gap: 10px;
        }

        .clue-info {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
            min-width: 120px;
            padding-right: 5px;
        }

        .clue-icon { font-size: 1.5rem; flex-shrink: 0; }
        .clue-text { font-weight: 600; font-size: 0.9rem; color: #444; line-height: 1.2; }
        
        .clue-inputs { 
            display: flex; 
            gap: 3px; 
            flex-wrap: wrap;
            justify-content: flex-end;
        }

        /* --- Input Box Styling --- */
        .letter-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex-shrink: 0;
        }

        input.letter-box {
            width: 28px; height: 34px;
            text-align: center; font-size: 1.1rem; font-weight: bold;
            text-transform: uppercase;
            border: 2px solid #cbd5e0; border-radius: 5px;
            background-color: #f8fafc; color: var(--box-bg);
            transition: all 0.2s; padding: 0;
            flex-shrink: 0;
        }
        
        .punctuation-box {
             width: 28px; height: 34px;
             display: flex; justify-content: center; align-items: flex-end;
             font-size: 1.5rem; font-weight: bold; color: var(--box-bg);
             padding-bottom: 5px;
             flex-shrink: 0;
        }

        input.letter-box:focus {
            outline: none; border-color: var(--primary);
            background-color: white; transform: translateY(-2px);
            z-index: 10;
        }

        input.letter-box.highlight { background-color: #dbeafe; border-color: #93c5fd; }
        input.letter-box.correct { background-color: var(--primary); color: white; border-color: var(--primary); }

        .letter-number {
            font-size: 0.6rem; font-weight: bold; color: #7f8c8d; margin-top: 2px;
        }

        /* --- Footer --- */
        footer {
            margin-top: auto;
            padding: 20px;
            text-align: center;
            font-weight: 600;
            color: var(--box-bg);
            background: white;
            width: 100%;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
            border-radius: 15px 15px 0 0;
        }

        /* --- Modals --- */
        #win-modal {
            display: none; position: fixed; top: 50%; left: 50%;
            transform: translate(-50%, -50%); background: white;
            padding: 30px; border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            text-align: center; z-index: 100;
            max-width: 90%;
        }
        
        #win-modal h2 { margin: 0 0 10px 0; color: var(--success); }
        #win-modal p { margin-bottom: 20px; color: #555; }
        
        #next-btn {
            background: var(--primary); color: white; border: none;
            padding: 12px 24px; border-radius: 30px;
            cursor: pointer; font-size: 1rem; font-weight: bold;
            transition: background 0.2s;
        }
        #next-btn:hover { background: #357abd; }

        #overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); z-index: 99;
        }

        /* --- MOBILE RESPONSIVENESS --- */
        @media (max-width: 480px) {
            h1 { font-size: 1.5rem; } /* Adjusted mobile font size */
            .header-container { flex-direction: column; margin-bottom: 15px; }
            .title-logo { margin: 0 0 10px 0; height: 55px; /* Slightly smaller on very small screens */ }
            
            input.letter-box, .punctuation-box {
                width: 24px; height: 30px; font-size: 0.9rem;
            }
            
            #quote-area { padding: 15px; gap: 8px; }
            .clue-row { flex-direction: column; align-items: flex-start; }
            .clue-inputs { width: 100%; justify-content: flex-start; margin-top: 5px; }
        }

    </style>
</head>
<body>

    <div class="header-container">
        <h1>
            <img src="logo.png" alt="Logo" class="title-logo" onerror="this.style.display='none'">
            Î’Ï…Î¶Î±Î½Ï„Î¹Î½Î¬ ÎšÏÏ…Ï€Ï„ÏŒÎ»ÎµÎ¾Î±
        </h1>
    </div>

    <main>
        <div id="quote-area"></div>
        <div id="clues-area"></div>
    </main>

    <footer>
        âœ¨âœï¸ Î Î±Î½Î±Î³Î¹ÏÏ„Î·Ï‚ Î”ÏŒÎ¼Î²ÏÎ¿Ï‚, Î•ÎºÏ€Î±Î¹Î´ÎµÏ…Ï„Î¹ÎºÏŒÏ‚ Î‘Î³Î³Î»Î¹ÎºÏÎ½ ÎºÎ±Î¹ Î˜ÎµÎ±Ï„ÏÎ¿Î»ÏŒÎ³Î¿Ï‚ âœï¸âœ¨
    </footer>

    <div id="overlay"></div>
    <div id="win-modal">
        <h2>ğŸ‰ Î£Ï…Î³Ï‡Î±ÏÎ·Ï„Î®ÏÎ¹Î±!</h2>
        <p>Î— Î»ÏÏƒÎ· Î®Ï„Î±Î½:<br><strong id="final-msg"></strong></p>
        <button id="next-btn">Î•Ï€ÏŒÎ¼ÎµÎ½Î¿Ï‚ Î“ÏÎ¯Ï†Î¿Ï‚ â–¶</button>
    </div>

    <script>
        // ==========================================
        // 1. Î¤Î‘ Î”Î•Î”ÎŸÎœÎ•ÎÎ‘ (THE DATA)
        // ==========================================
        
        // Î¤ÏÎ¬Ï€ÎµÎ¶Î± Î’Ï…Î¶Î±Î½Ï„Î¹Î½ÏÎ½ Î¦ÏÎ¬ÏƒÎµÏ‰Î½ & ÎŸÎ½Î¿Î¼Î¬Ï„Ï‰Î½
        const quoteBank = [
            "ÎÎ™Î¨ÎŸÎ Î‘ÎÎŸÎœÎ—ÎœÎ‘Î¤Î‘ ÎœÎ— ÎœÎŸÎÎ‘Î ÎŸÎ¨Î™Î", // ÎšÎ±ÏÎºÎ¹Î½Î¹ÎºÎ® ÎµÏ€Î¹Î³ÏÎ±Ï†Î® (Î‘Î³Î¯Î± Î£Î¿Ï†Î¯Î±)
            "Î•Î‘Î›Î© Î— Î ÎŸÎ›Î™Î£", // Î— Î Ï„ÏÏƒÎ· Ï„Î·Ï‚ Î ÏŒÎ»Î·Ï‚
            "Î’Î‘Î£Î™Î›Î•Î¥Î£ Î’Î‘Î£Î™Î›Î•Î©Î Î’Î‘Î£Î™Î›Î•Î¥Î©Î Î’Î‘Î£Î™Î›Î•Î¥ÎŸÎ¥Î£Î™", // Î¡Î·Ï„ÏŒ Î Î±Î»Î±Î¹Î¿Î»ÏŒÎ³Ï‰Î½
            "Î¤Î— Î¥Î Î•Î¡ÎœÎ‘Î§Î© Î£Î¤Î¡Î‘Î¤Î—Î“Î© Î¤Î‘ ÎÎ™ÎšÎ—Î¤Î—Î¡Î™Î‘", // Î‘ÎºÎ¬Î¸Î¹ÏƒÏ„Î¿Ï‚ ÎÎ¼Î½Î¿Ï‚
            "Î•Î Î¤ÎŸÎ¥Î¤Î© ÎÎ™ÎšÎ‘", // ÎŒÏÎ±Î¼Î± Îœ. ÎšÏ‰Î½ÏƒÏ„Î±Î½Ï„Î¯Î½Î¿Ï…
            "Î‘Î“Î™Î‘ Î£ÎŸÎ¦Î™Î‘ Î— Î¤ÎŸÎ¥ Î˜Î•ÎŸÎ¥ Î£ÎŸÎ¦Î™Î‘", // ÎŸ ÎÎ±ÏŒÏ‚
            "Î™ÎŸÎ¥Î£Î¤Î™ÎÎ™Î‘ÎÎŸÎ£ ÎŸ ÎœÎ•Î“Î‘Î£", // Î‘Ï…Ï„Î¿ÎºÏÎ¬Ï„Î¿ÏÎ±Ï‚
            "ÎšÎ©ÎÎ£Î¤Î‘ÎÎ¤Î™ÎÎŸÎ£ ÎŸ Î Î‘Î›Î‘Î™ÎŸÎ›ÎŸÎ“ÎŸÎ£", // Î¤ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿Ï‚ Î‘Ï…Ï„Î¿ÎºÏÎ¬Ï„Î¿ÏÎ±Ï‚
            "Î’Î‘Î£Î™Î›Î•Î™ÎŸÎ£ ÎŸ Î’ÎŸÎ¥Î›Î“Î‘Î¡ÎŸÎšÎ¤ÎŸÎÎŸÎ£", // ÎœÎ±ÎºÎµÎ´Î¿Î½Î¹ÎºÎ® Î”Ï…Î½Î±ÏƒÏ„ÎµÎ¯Î±
            "Î‘ÎÎÎ‘ ÎšÎŸÎœÎÎ—ÎÎ— Î— Î‘Î›Î•ÎÎ™Î‘Î”Î‘", // Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒÏ‚
            "Î¤ÎŸ Î’Î¥Î–Î‘ÎÎ¤Î™ÎŸÎ Î•Î£Î¤Î™Î Î— Î‘Î¡Î§Î— Î¤ÎŸÎ¥ ÎšÎŸÎ£ÎœÎŸÎ¥", // Î¦ÏÎ¬ÏƒÎ·
            "ÎŸ Î ÎŸÎ¡Î¦Î¥Î¡ÎŸÎ“Î•ÎÎÎ—Î¤ÎŸÎ£", // Î¤Î¯Ï„Î»Î¿Ï‚
            "Î— Î¡Î©ÎœÎ‘ÎÎ™Î‘ Î Î‘Î¡Î˜Î•Î", // Î”Î·Î¼Î¿Ï„Î¹ÎºÏŒ Ï„ÏÎ±Î³Î¿ÏÎ´Î¹ Î ÏŒÎ½Ï„Î¿Ï…
            "Î£Î©Î Î‘Î£Î• ÎšÎ¥Î¡Î‘ Î”Î•Î£Î ÎŸÎ™ÎÎ‘ ÎšÎ‘Î™ ÎœÎ— Î ÎŸÎ›Î¥Î”Î‘ÎšÎ¡Î¥Î–Î•Î™Î£", // Î˜ÏÏÎ»Î¿Ï‚
            "ÎšÎ¥Î¡Î™Î• Î•Î›Î•Î—Î£ÎŸÎ", // Î ÏÎ¿ÏƒÎµÏ…Ï‡Î®
            "Î— Î ÎŸÎ›Î™Î£ Î¤Î©Î Î ÎŸÎ›Î•Î©Î", // Î“Î¹Î± Ï„Î·Î½ ÎšÏ‰Î½ÏƒÏ„Î±Î½Ï„Î¹Î½Î¿ÏÏ€Î¿Î»Î·
            "Î˜Î•ÎŸÎ”Î©Î¡Î‘ Î— Î‘Î¥Î¤ÎŸÎšÎ¡Î‘Î¤Î•Î™Î¡Î‘", // Î£ÏÎ¶Ï…Î³Î¿Ï‚ Î™Î¿Ï…ÏƒÏ„Î¹Î½Î¹Î±Î½Î¿Ï
            "ÎŸÎ™ ÎœÎ Î›Î• ÎšÎ‘Î™ ÎŸÎ™ Î Î¡Î‘Î£Î™ÎÎŸÎ™", // Î£Ï„Î¬ÏƒÎ· Ï„Î¿Ï… ÎÎ¯ÎºÎ±
            "Î¥Î“Î¡ÎŸÎ Î Î¥Î¡", // Î’Ï…Î¶Î±Î½Ï„Î¹Î½ÏŒ ÏŒÏ€Î»Î¿
            "ÎŸ Î”Î™ÎšÎ•Î¦Î‘Î›ÎŸÎ£ Î‘Î•Î¤ÎŸÎ£" // Î£ÏÎ¼Î²Î¿Î»Î¿
        ];

        // Î›ÎµÎ¾Î¹ÎºÏŒ Î›Î­Î¾ÎµÏ‰Î½ Î³Î¹Î± Î²Î¿Î®Î¸ÎµÎ¹Î± (Greek Dictionary for Clues)
        const clueDictionary = [
            { w: "Î‘Î“Î™ÎŸÎ£", h: "Î™ÎµÏÏŒ Ï€ÏÏŒÏƒÏ‰Ï€Î¿", i: "ğŸ™" },
            { w: "Î ÎŸÎ›Î—", h: "ÎœÎµÎ³Î¬Î»Î¿Ï‚ Î¿Î¹ÎºÎ¹ÏƒÎ¼ÏŒÏ‚", i: "ğŸ™ï¸" },
            { w: "ÎÎŸÎœÎŸÎ£", h: "ÎšÎ±Î½ÏŒÎ½Î±Ï‚ Î´Î¹ÎºÎ±Î¯Î¿Ï…", i: "âš–ï¸" },
            { w: "Î§Î¡Î¥Î£ÎŸÎ£", h: "Î Î¿Î»ÏÏ„Î¹Î¼Î¿ Î¼Î­Ï„Î±Î»Î»Î¿", i: "ğŸ¥‡" },
            { w: "ÎÎ‘ÎŸÎ£", h: "Î•ÎºÎºÎ»Î·ÏƒÎ¯Î±", i: "â›ª" },
            { w: "Î¦Î©Î£", h: "Î›Î¬Î¼ÏˆÎ·", i: "ğŸ’¡" },
            { w: "Î¥Î”Î©Î¡", h: "ÎÎµÏÏŒ (Î±ÏÏ‡Î±Î¯Î±)", i: "ğŸ’§" },
            { w: "Î”ÎŸÎÎ‘", h: "Î¤Î¹Î¼Î® ÎºÎ±Î¹ Ï†Î®Î¼Î·", i: "ğŸŒŸ" },
            { w: "Î£Î¤Î¡Î‘Î¤ÎŸÎ£", h: "Î•Î½ÏÏ€Î»ÎµÏ‚ Î´Ï…Î½Î¬Î¼ÎµÎ¹Ï‚", i: "âš”ï¸" },
            { w: "Î‘Î¡Î¤ÎŸÎ£", h: "Î¨Ï‰Î¼Î¯", i: "ğŸ¥–" },
            { w: "ÎŸÎ™ÎÎŸÎ£", h: "ÎšÏÎ±ÏƒÎ¯", i: "ğŸ·" },
            { w: "Î’Î™ÎŸÎ£", h: "Î–Ï‰Î®", i: "ğŸŒ±" },
            { w: "Î“Î—", h: "Î Î»Î±Î½Î®Ï„Î·Ï‚ Î® Î­Î´Î±Ï†Î¿Ï‚", i: "ğŸŒ" },
            { w: "Î˜Î‘Î›Î‘Î£Î£Î‘", h: "ÎœÎµÎ³Î¬Î»Î¿ Î½ÎµÏÏŒ", i: "ğŸŒŠ" },
            { w: "Î Î›ÎŸÎ™ÎŸ", h: "ÎšÎ±ÏÎ¬Î²Î¹", i: "â›µ" },
            { w: "Î™Î Î ÎŸÎ£", h: "Î†Î»Î¿Î³Î¿", i: "ğŸ" },
            { w: "ÎÎ™Î¦ÎŸÎ£", h: "Î£Ï€Î±Î¸Î¯", i: "ğŸ—¡ï¸" },
            { w: "Î‘Î£Î Î™Î”Î‘", h: "Î‘Î¼Ï…Î½Ï„Î¹ÎºÏŒ ÏŒÏ€Î»Î¿", i: "ğŸ›¡ï¸" },
            { w: "Î’Î™Î’Î›Î™ÎŸ", h: "Î‘Î½Î¬Î³Î½Ï‰ÏƒÎ¼Î±", i: "ğŸ“–" },
            { w: "Î“Î¡Î‘Î¦Î—", h: "ÎšÎµÎ¯Î¼ÎµÎ½Î¿", i: "âœï¸" },
            { w: "Î•Î™ÎšÎŸÎÎ‘", h: "Î˜ÏÎ·ÏƒÎºÎµÏ…Ï„Î¹ÎºÎ® Î¶Ï‰Î³ÏÎ±Ï†Î¹Î¬", i: "ğŸ–¼ï¸" },
            { w: "Î¨Î¥Î§Î—", h: "Î Î½ÎµÏÎ¼Î±", i: "ğŸ‘»" },
            { w: "Î£Î©ÎœÎ‘", h: "Î¦Ï…ÏƒÎ¹ÎºÎ® Ï…Ï€ÏŒÏƒÏ„Î±ÏƒÎ·", i: "ğŸ§" },
            { w: "Î—Î›Î™ÎŸÎ£", h: "Î†ÏƒÏ„ÏÎ¿ Ï„Î·Ï‚ Î·Î¼Î­ÏÎ±Ï‚", i: "â˜€ï¸" },
            { w: "ÎÎ¥Î§Î¤Î‘", h: "Î£ÎºÎ¿Ï„Î¬Î´Î¹", i: "ğŸŒ™" },
            { w: "Î‘Î•Î¤ÎŸÎ£", h: "Î ÎµÏÎ®Ï†Î±Î½Î¿ Ï€Î¿Ï…Î»Î¯", i: "ğŸ¦…" },
            { w: "Î›Î•Î©Î", h: "Î›Î¹Î¿Î½Ï„Î¬ÏÎ¹", i: "ğŸ¦" },
            { w: "Î¡ÎŸÎ”ÎŸ", h: "Î¤ÏÎ¹Î±Î½Ï„Î¬Ï†Ï…Î»Î»Î¿", i: "ğŸŒ¹" },
            { w: "Î¦Î™Î›ÎŸÎ£", h: "Î‘Î³Î±Ï€Î·Ï„ÏŒÏ‚", i: "ğŸ¤" },
            { w: "Î•Î§Î˜Î¡ÎŸÎ£", h: "Î‘Î½Ï„Î¯Ï€Î±Î»Î¿Ï‚", i: "ğŸ˜ " },
            { w: "Î¤Î•Î™Î§ÎŸÎ£", h: "Î ÏÎ¿ÏƒÏ„Î±Ï„ÎµÏ…Ï„Î¹ÎºÏŒÏ‚ Ï„Î¿Î¯Ï‡Î¿Ï‚", i: "ğŸ§±" },
            { w: "Î Î¥Î›Î—", h: "ÎœÎµÎ³Î¬Î»Î· Ï€ÏŒÏÏ„Î±", i: "ğŸšª" },
            { w: "Î§Î¡ÎŸÎÎŸÎ£", h: "ÎÏÎ± ÎºÎ±Î¹ ÎºÎ±Î¹ÏÏŒÏ‚", i: "â³" },
            { w: "Î‘Î“Î“Î•Î›ÎŸÎ£", h: "ÎŸÏ…ÏÎ¬Î½Î¹Î¿ Ï€Î»Î¬ÏƒÎ¼Î±", i: "ğŸ‘¼" },
            { w: "Î£Î¤Î•ÎœÎœÎ‘", h: "Î¦Î¿ÏÎ¬ÎµÎ¹ Î¿ Î’Î±ÏƒÎ¹Î»Î¹Î¬Ï‚", i: "ğŸ‘‘" },
            { w: "Î˜Î¡ÎŸÎÎŸÎ£", h: "ÎšÎ¬Î¸Î¹ÏƒÎ¼Î± Î’Î±ÏƒÎ¹Î»Î¹Î¬", i: "ğŸ’º" },
            { w: "Î”Î¡ÎŸÎœÎŸÎ£", h: "ÎŸÎ´ÏŒÏ‚", i: "ğŸ›£ï¸" },
            { w: "ÎŸÎ™ÎšÎŸÎ£", h: "Î£Ï€Î¯Ï„Î¹", i: "ğŸ " },
            { w: "ÎšÎ—Î ÎŸÎ£", h: "Î ÏÎ¬ÏƒÎ¹Î½Î· Î±Ï…Î»Î®", i: "ğŸŒ³" },
            { w: "ÎœÎ—Î›ÎŸ", h: "Î¦ÏÎ¿ÏÏ„Î¿", i: "ğŸ" },
            { w: "Î Î•Î¤Î¡Î‘", h: "Î›Î¯Î¸Î¿Ï‚", i: "ğŸª¨" },
            { w: "Î§Î‘Î¡Î¤Î—Î£", h: "Î”ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï„ÏŒÏ€Î¿Ï…Ï‚", i: "ğŸ—ºï¸" }
        ];

        // ==========================================
        // 2. LOGIC (ÎœÎ—Î§Î‘ÎÎ™Î£ÎœÎŸÎ£)
        // ==========================================

        let currentQuote = "";
        let activeMapping = {};
        let availableQuotes = [];

        // Helper: Remove Greek Accents (Î† -> Î‘)
        function cleanGreek(str) {
            return str.normalize('NFD').replace(/[\u0300-\u036f]/g, "").toUpperCase();
        }

        // Generate Random Mapping for Greek Alphabet
        function generateMapping(quoteText) {
            const map = {};
            const usedNumbers = new Set();
            const cleanText = cleanGreek(quoteText);
            const uniqueChars = [...new Set(cleanText.split(''))].filter(c => c.match(/[Î‘-Î©]/));

            uniqueChars.forEach(char => {
                let num;
                do {
                    num = Math.floor(Math.random() * 30) + 1;
                } while (usedNumbers.has(num));
                
                usedNumbers.add(num);
                map[char] = num;
            });
            return map;
        }

        // SMART CLUE GENERATOR (GREEK VERSION)
        function generateSmartClues(quoteText) {
            let neededChars = new Set([...cleanGreek(quoteText).split('')].filter(c => c.match(/[Î‘-Î©]/)));
            let selectedClues = [];
            let safetyCounter = 0;

            while (neededChars.size > 0 && safetyCounter < 100) {
                let bestWordObj = null;
                let maxNewCoverage = 0;
                
                const shuffledDict = clueDictionary.sort(() => 0.5 - Math.random());

                for (let item of shuffledDict) {
                    if (selectedClues.includes(item)) continue;

                    let coverCount = 0;
                    const cleanWord = cleanGreek(item.w);
                    
                    for (let char of cleanWord) {
                        if (neededChars.has(char)) coverCount++;
                    }

                    if (coverCount > maxNewCoverage) {
                        maxNewCoverage = coverCount;
                        bestWordObj = item;
                    }
                }

                if (bestWordObj) {
                    selectedClues.push(bestWordObj);
                    const cleanWord = cleanGreek(bestWordObj.w);
                    for (let char of cleanWord) neededChars.delete(char);
                } else {
                    break;
                }
                safetyCounter++;
            }
            return selectedClues;
        }

        function extendMappingForClues(map, clueList) {
            const usedNumbers = new Set(Object.values(map));
            clueList.forEach(clue => {
                const cleanWord = cleanGreek(clue.w);
                for (let char of cleanWord) {
                    if (!map[char]) {
                        let num;
                        do {
                            num = Math.floor(Math.random() * 30) + 1;
                        } while (usedNumbers.has(num));
                        usedNumbers.add(num);
                        map[char] = num;
                    }
                }
            });
            return map;
        }

        // ==========================================
        // 3. UI RENDERING
        // ==========================================

        const quoteArea = document.getElementById('quote-area');
        const cluesArea = document.getElementById('clues-area');
        const overlay = document.getElementById('overlay');
        const winModal = document.getElementById('win-modal');
        const finalMsg = document.getElementById('final-msg');

        function createLetterBox(rawChar, isClueSection = false) {
            const container = document.createElement('div');
            container.className = 'letter-container';
            const char = cleanGreek(rawChar);

            if (activeMapping[char]) {
                const input = document.createElement('input');
                input.type = 'text';
                input.maxLength = 1;
                input.className = 'letter-box';
                
                const num = activeMapping[char];
                const numberLabel = document.createElement('span');
                numberLabel.className = 'letter-number';
                numberLabel.innerText = num;

                input.dataset.number = num;
                input.dataset.answer = char;
                
                input.addEventListener('input', (e) => handleInput(e, num));
                input.addEventListener('focus', () => highlightGroup(num, true));
                input.addEventListener('blur', () => highlightGroup(num, false));
                input.addEventListener('keyup', (e) => {
                     // Check if input is a Greek char or Latin char
                     if(e.key.length === 1 && (e.key.match(/[Î±-Ï‰Î‘-Î©]/) || e.key.match(/[a-zA-Z]/))) {
                         let next = container.nextElementSibling; 
                         if(next && next.querySelector('input')) {
                             next.querySelector('input').focus();
                         }
                     }
                });

                container.appendChild(input);
                container.appendChild(numberLabel);
            } else if (!char.match(/[Î‘-Î©]/) && char !== ' ') {
                if(!isClueSection) {
                    const punct = document.createElement('div');
                    punct.className = 'punctuation-box';
                    punct.innerText = rawChar;
                    return punct;
                }
            } else if (char === ' ') {
                return null; 
            }
            return container;
        }

        function loadRandomPuzzle() {
            quoteArea.innerHTML = '';
            cluesArea.innerHTML = '';
            overlay.style.display = 'none';
            winModal.style.display = 'none';

            if (availableQuotes.length === 0) {
                availableQuotes = [...quoteBank];
            }
            const randIndex = Math.floor(Math.random() * availableQuotes.length);
            currentQuote = availableQuotes[randIndex];
            availableQuotes.splice(randIndex, 1);

            const generatedClues = generateSmartClues(currentQuote);
            activeMapping = generateMapping(currentQuote);
            activeMapping = extendMappingForClues(activeMapping, generatedClues);

            const words = currentQuote.split(' ');
            words.forEach(word => {
                const wordGroup = document.createElement('div');
                wordGroup.className = 'word-group';
                for (let char of word) {
                    const box = createLetterBox(char);
                    if(box) wordGroup.appendChild(box);
                }
                quoteArea.appendChild(wordGroup);
            });

            generatedClues.forEach(clue => {
                const row = document.createElement('div');
                row.className = 'clue-row';
                
                const infoDiv = document.createElement('div');
                infoDiv.className = 'clue-info';
                infoDiv.innerHTML = `<div class="clue-icon">${clue.i}</div><div class="clue-text">${clue.h}</div>`;

                const inputsDiv = document.createElement('div');
                inputsDiv.className = 'clue-inputs';
                const cleanWord = cleanGreek(clue.w);
                for (let char of cleanWord) {
                    const box = createLetterBox(char, true);
                    if(box) inputsDiv.appendChild(box);
                }

                row.appendChild(infoDiv);
                row.appendChild(inputsDiv);
                cluesArea.appendChild(row);
            });
        }

        function handleInput(e, numberId) {
            const val = cleanGreek(e.target.value);
            if (e.target.value !== val && val !== "") {
                e.target.value = val;
            }
            document.querySelectorAll(`input[data-number="${numberId}"]`).forEach(inp => {
                inp.value = val;
            });
            checkWin();
        }

        function highlightGroup(numberId, isActive) {
            document.querySelectorAll(`input[data-number="${numberId}"]`).forEach(inp => {
                inp.classList.toggle('highlight', isActive);
            });
        }

        function checkWin() {
            const quoteInputs = quoteArea.querySelectorAll('input.letter-box');
            let isFull = true; 
            let isCorrect = true;

            quoteInputs.forEach(input => {
                if (!input.value) isFull = false;
                if (cleanGreek(input.value) !== input.dataset.answer) isCorrect = false;
            });

            if (isFull && isCorrect) {
                document.querySelectorAll('input.letter-box').forEach(i => i.classList.add('correct'));
                finalMsg.innerText = currentQuote;
                setTimeout(() => {
                    overlay.style.display = 'block';
                    winModal.style.display = 'block';
                }, 500);
            }
        }

        document.getElementById('next-btn').addEventListener('click', loadRandomPuzzle);

        loadRandomPuzzle();

    </script>
</body>
</html>